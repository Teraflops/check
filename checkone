spark-shell \
  --master yarn \
  --deploy-mode client \
  --conf spark.eventLog.enabled=false \
  --conf spark.sql.adaptive.enabled=true \
  --conf spark.sql.adaptive.coalescePartitions.enabled=true \
  --conf spark.sql.shuffle.partitions=200 \
  --conf spark.default.parallelism=200 \
  --conf spark.executor.instances=8 \
  --conf spark.executor.cores=3 \
  --conf spark.executor.memory=6g \
  --conf spark.executor.memoryOverhead=2g \
  --conf spark.driver.memory=8g \
  --conf spark.driver.maxResultSize=2g \
  --conf spark.sql.files.maxPartitionBytes=134217728   # 128MB
